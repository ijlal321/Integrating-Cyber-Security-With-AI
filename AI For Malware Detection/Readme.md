
# Title : AI for Malware Detection 

## Table of Contents

1. [Introduction](#introduction)
2. [Data Loading](#data-loading)
3. [Data Analysis and Preprocessing](#data-analysis-and-preprocessing)
   - [Data Description and Preprocessing](#data-description-and-preprocessing)
   - [Data Visualization](#data-visualization)
   - [Feature Scaling and Splitting](#feature-scaling-and-splitting)
4. [Training ML Algorithms](#training-ml-algorithms)
   - [Model Training and Evaluation](#model-training-and-evaluation)
   - [Saving the Best Model](#saving-the-best-model)
5. [Loading Saved Model](#loading-saved-model)
6. [Conclusion](#conclusion)

## 1. Introduction <a name="introduction"></a>

This project aims to develop a machine learning model for detecting malware using features extracted from Portable Executable (PE) files. The dataset used in this project is sourced from [Kaggle](https://www.kaggle.com/datasets/amauricio/pe-files-malwares), containing various attributes of PE files along with a binary label indicating whether they are malware or not.

## 2. Data Loading <a name="data-loading"></a>

The first step involves loading the dataset into memory for analysis and model training. The code snippet below demonstrates this process using the Pandas library in Python.

```python
import numpy as np
import pandas as pd

data = pd.read_csv("dataset_malwares.csv")
```

## 3. Data Analysis and Preprocessing <a name="data-analysis-and-preprocessing"></a>

### Data Description and Preprocessing <a name="data-description-and-preprocessing"></a>

After loading the data, a brief exploration and preprocessing are performed. The `describe()` function provides statistical information about the dataset, and the `drop()` function removes unnecessary columns that are not relevant for modeling.

```python
data.describe()
data.drop(['Name', 'Machine', 'TimeDateStamp', 'SectionMainChar'], axis=1, inplace=True)
```

### Data Visualization <a name="data-visualization"></a>

Visualizing the distribution of the target variable 'Malware' helps understand the dataset better. The histogram plot shows the frequency of malware and non-malware samples in the dataset.

```python
import seaborn as sns
import matplotlib.pyplot as plt

data['Malware'].hist()
plt.xlabel('Malware')
plt.ylabel('Frequency')
plt.title('Distribution of Malware')
plt.show()
```

![Histogram](https://github.com/ijlal321/Integrating-Cyber-Security-With-AI/assets/103317626/9608328e-d988-4179-a3fc-55357ff01bc7)


### Feature Scaling and Splitting <a name="feature-scaling-and-splitting"></a>

The features are scaled using MinMaxScaler to bring them within a specific range and prevent bias in model training. The dataset is then split into training and testing sets for model evaluation.

```python
from sklearn.preprocessing import MinMaxScaler
from sklearn.model_selection import train_test_split

scaler = MinMaxScaler()
features = data.drop("Malware", axis=1)
targets = data['Malware']
features_scaled = scaler.fit_transform(features)

X_train, X_test, y_train, y_test = train_test_split(features_scaled, targets, test_size=0.2, stratify=targets)
```

## 4. Training ML Algorithms <a name="training-ml-algorithms"></a>

### Model Training and Evaluation <a name="model-training-and-evaluation"></a>

Various machine learning algorithms are trained and evaluated using the training and testing sets. Three classifiers are used: K-Nearest Neighbors (KNN), Random Forest Classifier (RFC), and Logistic Regression (LR). The accuracy scores are computed to evaluate their performance.

```python
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score

knn = KNeighborsClassifier()
knn.fit(X_train, y_train)
accuracy_score(y_test, knn.predict(X_test))  # Example: 0.9711955136375223

rfc = RandomForestClassifier()
rfc.fit(X_train, y_train)
accuracy_score(y_test, rfc.predict(X_test))  # Example: 0.9892939077236809

lr = LogisticRegression()
lr.fit(X_train, y_train)
accuracy_score(y_test, lr.predict(X_test))  # Example: 0.9576854448126434
```

### Saving the Best Model <a name="saving-the-best-model"></a>

The best-performing model (Random Forest Classifier) is saved for future use. Both the trained model and the scaler used for feature scaling are serialized and saved as pickle files.

```python
import pickle

model_file = "malware_predictor.pkl"
with open(model_file, "wb") as file:
    pickle.dump(rfc, file)

scaler_file = "malware_scaler.pkl"
with open(scaler_file, "wb") as file:
    pickle.dump(scaler, file)
```

## 5. Loading Saved Model <a name="loading-saved-model"></a>

Finally, the saved model can be loaded and used for predicting on new data.

```python
with open(model_file, "rb") as file:
    rfc_loaded = pickle.load(file)
```

## 6. Conclusion <a name="conclusion"></a>

In conclusion, this project successfully demonstrates the process of building and evaluating a machine learning model for malware detection using PE file features. The steps involved data loading, analysis, preprocessing, model training, evaluation, and saving/loading for future use. The Random Forest Classifier achieved a high accuracy score of approximately 98.93% on the test dataset, making it a suitable candidate for real-world deployment in malware detection systems.

